javascript:function getBaseImage(){if(-1!=window.location.href.indexOf("/p/")||-1!=window.location.href.indexOf("/tv/")){let s=window.location.href.split("instagram.com")[1];var e=new XMLHttpRequest;if(e.open("GET",'https://www.instagram.com/graphql/query/?query_hash=8c1ccd0d1cab582bafc9df9f5983e80d&variables={"shortcode":"'+s.replace("/p/","").replace("/tv/","").split("/")[0]+'","child_comment_count":3,"fetch_comment_count":40,"parent_comment_count":24,"has_threaded_comments":true}',!1),e.send(null),200===e.status){let s=JSON.parse(e.responseText);if("GraphSidecar"!=s.data.shortcode_media.__typename){let e="";e=s.data.shortcode_media.is_video?s.data.shortcode_media.video_url:s.data.shortcode_media.display_resources[s.data.shortcode_media.display_resources.length-1].src,window.open(e,"_blank")}else{let e=[];for(post of(console.log(s),s.data.shortcode_media.edge_sidecar_to_children.edges))post.node.is_video?e.push(post.node.video_url):e.push(post.node.display_resources[post.node.display_resources.length-1].src);buildSelector(e.reverse())}}}else if(-1!=window.location.href.indexOf("/highlights/"))saveStoryHighlights();else if(-1!=window.location.href.indexOf("stories/tags/"))saveStoryHashtag();else{if(-1==window.location.href.indexOf("/stories/"))return void alert("Bitte erst ein Bild anklicken!");saveStory()}}function saveStory(){let e=getUserId(window.location.href.split("/stories/")[1].split("/")[0]),s=window.location.href.split("/stories/")[1].split("/")[1].split("/")[0];var t=new XMLHttpRequest;if(t.open("GET",'https://www.instagram.com/graphql/query/?query_hash=0a85e6ea60a4c99edc58ab2f3d17cfdf&variables={"reel_ids":["'+e+'"],"location_ids":[],"precomposed_overlay":false}',!1),t.send(null),200===t.status){let e=JSON.parse(t.responseText),o="";for(item of e.data.reels_media[0].items)item.id==s&&(o=item.is_video?item.video_resources[item.video_resources.length-1].src:item.display_resources[item.display_resources.length-1].src);window.open(o,"_blank")}}function saveStoryHighlights(){storyId=window.location.href.split("/stories/highlights/")[1].split("/")[0];var e=new XMLHttpRequest;e.open("GET",'https://www.instagram.com/graphql/query/?query_hash=0a85e6ea60a4c99edc58ab2f3d17cfdf&variables={"reel_ids":[],"tag_names":[],"location_ids":[],"highlight_reel_ids":["'+storyId+'"],"precomposed_overlay":false,"show_story_viewer_list":true,"story_viewer_fetch_count":50,"story_viewer_cursor":"","stories_video_dash_manifest":false}',!1),e.send(null);let s=[];if(200===e.status){let t=JSON.parse(e.responseText),o="";for(item of(console.log(t,storyId),t.data.reels_media[0].items))o=item.is_video?item.video_resources[item.video_resources.length-1].src:item.display_resources[item.display_resources.length-1].src,s.push(o);buildSelector(s)}}function saveStoryHashtag(){storyId=window.location.href.split("/stories/tags/")[1].split("/")[0];var e=new XMLHttpRequest;e.open("GET",'https://www.instagram.com/graphql/query/?query_hash=0a85e6ea60a4c99edc58ab2f3d17cfdf&variables={"reel_ids":[],"tag_names":["'+storyId+'"],"location_ids":[],"highlight_reel_ids":[],"precomposed_overlay":false,"show_story_viewer_list":true,"story_viewer_fetch_count":50,"story_viewer_cursor":"","stories_video_dash_manifest":false}',!1),e.send(null);let s=[];if(200===e.status){let t=JSON.parse(e.responseText),o="";for(item of(console.log("Hashtag",t,storyId),t.data.reels_media[0].items))o=item.is_video?item.video_resources[item.video_resources.length-1].src:item.display_resources[item.display_resources.length-1].src,s.push(o);buildSelector(s)}}function getUserId(e){var s=new XMLHttpRequest;if(s.open("GET","https://www.instagram.com/"+e+"/?__a=1",!1),s.send(null),200===s.status){return JSON.parse(s.responseText).logging_page_id.split("_")[1]}}function buildSelector(e){let s="<title>Post-Downloader by Julian</title>";for(url_ of e.reverse())-1!=url_.indexOf(".mp4")?s+='<a href="'+url_+'" target="_blank"><video width="360"><source src="'+url_+'" type="video/mp4" /></video></a>':s+='<a href="'+url_+'" target="_blank"><img src="'+url_+'" width="360" /></a>';console.log(s),w=window.open("selector.html"),w.onload=function(){w.document.write(s);let e=w.document.getElementsByTagName("video");for(vid of e)vid.volume=0,vid.loop=!0,vid.play()}}getBaseImage();
